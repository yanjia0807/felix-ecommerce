(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(e){var i=function(e,i){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,i||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(e,"string");return"symbol"==t(i)?i:i+""}var r,o=function(){return i=function t(e,i,n,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$=e,this.$theForm=i,this.fluentFormVars=n,this.formSelector=a,this.activeStep=0,this.isRtl=!!window.fluentFormVars.is_rtl,this.isPopulatingStepData=!1,this.isInitialLoad=!0,this.fluentFormVars.stepAnimationDuration=parseInt(this.fluentFormVars.stepAnimationDuration),this.stepPersistency="yes"===this.$theForm.find(".ff-step-container").attr("data-enable_step_data_persistency"),this.stepResume=!1,this.stepPersistency&&(this.stepResume="yes"===this.$theForm.find(".ff-step-container").attr("data-enable_step_page_resume"))},a=[{key:"getPublicAPI",value:function(){return{init:this.init.bind(this),updateSlider:this.updateSlider.bind(this),populateFormDataAndSetActiveStep:this.populateFormDataAndSetActiveStep.bind(this)}}},{key:"init",value:function(){this.initFormWithSavedState(),this.removePrevFromFirstStep(),this.initStepSlider(),this.maybeAutoSlider()}},{key:"removePrevFromFirstStep",value:function(){this.$theForm.find(".fluentform-step:first").find('.step-nav [data-action="prev"]').remove()}},{key:"getFormInstance",value:function(){return window.fluentFormApp(this.$theForm)}},{key:"initFormWithSavedState",value:function(){var t=this;if(this.stepPersistency){var e=this.$,i=this;e(document).ready(function(n){var a,r;e.getJSON(t.fluentFormVars.ajaxUrl,{form_id:t.$theForm.data("form_id"),action:"fluentform_step_form_get_data",nonce:null===(a=t.fluentFormVars)||void 0===a?void 0:a.nonce,hash:null===(r=t.fluentFormVars)||void 0===r?void 0:r.hash}).then(function(t){t&&i.populateFormDataAndSetActiveStep(t)})})}}},{key:"populateFormDataAndSetActiveStep",value:function(t){var e=this,i=t.response,n=t.step_completed,a=this.$,r=[];if(a.each(i,function(t,i){if(i){var n=Object.prototype.toString.call(i);if("[object Object]"===n){var o=e.$theForm.find("[data-name=".concat(t,"]"));if(o.length&&"tabular-element"===o.attr("data-type"))jQuery.each(i,function(i,n){var r=e.$theForm.find('[name="'.concat(t,"[").concat(i,']\\[\\]"]'));r.length||(r=e.$theForm.find('[name="'.concat(t,"[").concat(i,']"]'))),a.each(r,function(t,e){var i=a(e).val();-1===a.inArray(i,n)&&i!==n||a(e).prop("checked",!0).change()})});else if("chained-select"===o.attr("data-type")){var s={meta_key:o.find("select:first").attr("data-meta_key"),form_id:o.closest("form").attr("data-form_id"),action:"fluentform_get_chained_select_options",filter_options:"all",keys:i};a.getJSON(e.fluentFormVars.ajaxUrl,s).then(function(t){a.each(t,function(t,e){var n=o.find("select[data-key='".concat(t,"']"));0!=n.attr("data-index")&&a.each(e,function(t,e){n.append(a("<option />",{value:e,text:e}))}),n.attr("disabled",!1).val(i[t])})})}else a.each(i,function(i,n){e.$theForm.find('[name="'.concat(t,"[").concat(i,']"]')).val(n).change()})}else if("[object Array]"===n){var f=e.$theForm.find("[name=".concat(t,"]"));if("file"===(f=(f=f.length?f:e.$theForm.find("[data-name=".concat(t,"]"))).length?f:e.$theForm.find("[name=".concat(t,"\\[\\]]"))).attr("type"))e.addFilesToElement(f,i);else if(f.prop("multiple"))if(a.isFunction(window.Choices)){var l=f.data("choicesjs");l&&r.push({handler:l,values:i})}else f.val(i).change();else if("repeater_field"===f.attr("data-type")){var c=f.find("tbody"),d=f.attr("data-name");a.each(i,function(t,e){0!=t?c.find("tr:last").clone().appendTo(c).find(".ff-el-form-control").each(function(i,n){var r="ffrpt-"+(new Date).getTime()+i;a(n).val(e[i]),a(n).attr({id:r,name:"".concat(d,"[").concat(t,"][]"),value:e[i]}).change()}):c.find("tr:first .ff-el-form-control").each(function(t,i){a(i).val(e[t]).change()})})}else f.each(function(t,e){-1!==a.inArray(a(e).val(),i)&&a(e).prop("checked",!0).change()})}else{var u=e.$theForm.find("[name=".concat(t,"]"));if(u.hasClass("fluentform-post-content")&&window.wp&&window.wp.editor){var p=u.attr("id");window.tinymce.get(p).setContent(i)}if("undefined"!=typeof flatpickr&&u.prop("_flatpickr")){var v=u.prop("_flatpickr");v&&(v.config.altInput?v.setDate(i,!0):u.val(i).trigger("change"))}if("radio"===u.prop("type")||"checkbox"===u.prop("type"))a("[name=".concat(t,'][value="').concat(i,'"]')).prop("checked",!0).change(),e.$theForm.find("[name=".concat(t,'][value="').concat(i,'"]')).prop("checked",!0).change(),u.closest(".ff-el-group").find(".ff-el-ratings").length&&e.$theForm.find("[name=".concat(t,'][value="').concat(i,'"]')).closest("label").trigger("mouseenter");else{u.hasClass("ff_has_multi_select")&&u.data("choicesjs")&&(u.data("choicesjs").removeActiveItems(i),u.data("choicesjs").setChoiceByValue(i));var h=u.closest(".ff-el-group").find(".fluentform-signature-pad");if(h.length){var m=h[0].getContext("2d"),_=new Image;_.src=i,_.onload=function(){m.drawImage(_,0,0)}}u.val(i).change()}}}}),r.length>0)for(var o=0;o<r.length;o++){var s,f=r[o].handler,l=r[o].values;f.setValue(l);var c=null===(s=f.passedElement)||void 0===s?void 0:s.element;c&&a(c).trigger("change")}this.isPopulatingStepData=!0;var d=this.fluentFormVars.stepAnimationDuration;this.stepResume&&this.updateSlider(n,d,!0).then(function(){e.handleFocus(d)}).catch(function(t){console.error("An error occurred during the slider update:",t)}),this.isPopulatingStepData=!1}},{key:"initStepSlider",value:function(){var t=this.$,e=this.$theForm.find(".fluentform-step"),i=e.length,n=this.$theForm.find(".ff-step-titles li");if(!window.ff_disable_auto_step){for(var a=this.activeStep,r=0;a<i&&this.isStepAllFieldsHidden(t(e[a]))&&r<i;)a++,r++;a!==this.activeStep&&a<i&&(this.activeStep=a)}e.css("display","none"),t(e[this.activeStep]).css("display","block"),e.attr("role","group"),e.attr("aria-hidden","true"),t(e[this.activeStep]).attr("aria-hidden","false"),t(e[this.activeStep]).addClass("active"),t(n[this.activeStep]).addClass("active");var o=e.first();o.hasClass("active")&&o.find('button[data-action="next"]').css("visibility","visible"),e.length&&!e.last().hasClass("active")&&this.$theForm.find('button[type="submit"]').css("visibility","hidden"),this.stepProgressBarHandle({activeStep:this.activeStep,totalSteps:i}),this.registerStepNavigators(this.fluentFormVars.stepAnimationDuration),this.registerClickableStepNav(n,e)}},{key:"registerClickableStepNav",value:function(t,e){var i=this.$,n=this;0!==t.length&&(i.each(t,function(t,e){i(e).attr("data-step-number",t),i(e).attr({role:"button",tabindex:"0","aria-label":"Go to step "+(t+1),style:"cursor: pointer;"})}),t.on("click keydown",function(t){if("keydown"!==t.type||"Enter"===t.key||" "===t.key||13===t.keyCode||32===t.keyCode){"keydown"===t.type&&t.preventDefault();var a=n.getFormInstance(),r=i(this),o=0,s=n.fluentFormVars.stepAnimationDuration;try{var f=r.data("step-number");if(isNaN(f))return;i.each(e,function(t,e){if(o=t,t<f){var n=i(e).find(":input").not(":button").filter(function(t,e){return!i(e).closest(".has-conditions").hasClass("ff_excluded")});n.length&&a.validate(n)}}),n.updateSlider(f,s,!0).then(function(){n.handleFocus(s)}).catch(function(t){console.error("An error occurred during the slider update:",t)})}catch(t){if(!(t instanceof window.ffValidationError))throw t;n.updateSlider(o,s,!0).then(function(){n.handleFocus(s)}).catch(function(t){console.error("An error occurred during the slider update:",t)}),a.showErrorMessages(t.messages),a.scrollToFirstError(350)}}}))}},{key:"stepProgressBarHandle",value:function(t){var e=this.$;if(this.$theForm.find(".ff-el-progress").length){var i=t.totalSteps,n=t.activeStep,a=100/i*(n+1),r=this.$theForm.find(".ff-el-progress-title li"),o=this.$theForm.find(".ff-step-header .ff-el-progress-bar"),s=o.find("span");o.css({transition:"width 0.3s ease-in-out",width:a+"%"}),a?o.append(s.text(parseInt(a)+"%")):s.empty();var f=this.fluentFormVars.step_text,l=e(r[n]).text();f=f.replace("%activeStep%",n+1).replace("%totalStep%",i).replace("%stepTitle%",l),this.$theForm.find(".ff-el-progress-status").html(f).attr("aria-live","polite"),r.css("display","none"),e(r[n]).css("display","inline")}}},{key:"isStepAllFieldsHidden",value:function(t){return this.$,t.find(".ff-el-group").not(".ff-custom_html").length,!1}},{key:"animateProgressToStep",value:function(t,e,i){this.$;var n=this.$theForm.find(".ff-step-header .ff-el-progress-bar");if(!n.length||!e)return Promise.resolve();var a=100/e*(t+1);return i&&i>0?n.css({transition:"width ".concat(i,"ms ease-in-out")}):n.css({transition:"none"}),n[0]&&n[0].offsetHeight,n.css("width",a+"%"),new Promise(function(t){var e=!1,a=setTimeout(function(){e||(e=!0,t())},(i||0)+120);n.one("transitionend webkitTransitionEnd oTransitionEnd",function(){e||(e=!0,clearTimeout(a),t())})})}},{key:"registerStepNavigators",value:function(t){var e=this.$,i=this;this.handleFocus(t),e(this.formSelector).on("click",".fluentform-step .step-nav button, .fluentform-step .step-nav img",function(n){var a=e(this).data("action"),r="next",o=e(this).closest(".fluentform-step"),s=i.getFormInstance();if("next"===a){try{var f=o.find(":input").not(":button").filter(function(t,i){return!e(i).closest(".has-conditions").hasClass("ff_excluded")});f.length&&s.validate(f),i.activeStep++}catch(n){if(!(n instanceof window.ffValidationError))throw n;return s.showErrorMessages(n.messages),void s.scrollToFirstError(350)}i.$theForm.trigger("ff_to_next_page",i.activeStep),e(document).trigger("ff_to_next_page",{step:i.activeStep,form:i.$theForm});var l=i.$theForm.find(".fluentform-step");i.$theForm.trigger("ff_render_dynamic_smartcodes",e(l[i.activeStep]))}else i.activeStep--,r="prev",i.$theForm.trigger("ff_to_prev_page",i.activeStep),e(document).trigger("ff_to_prev_page",{step:i.activeStep,form:i.$theForm});var c="yes"!=i.$theForm.find(".ff-step-container").attr("data-disable_auto_focus");i.updateSlider(i.activeStep,t,c,r).then(function(){i.handleFocus(t)}).catch(function(t){console.error("An error occurred during the slider update:",t)})})}},{key:"updateSlider",value:function(t,i){var n=this,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"next",o=this.$,s=this;return new Promise(function(f){o("div"+n.formSelector+"_errors").empty(),n.activeStep=t;var l=n.$theForm.find(".ff-step-titles li"),c=n.$theForm.find(".fluentform-step"),d=c.length;if(!window.ff_disable_auto_step&&d){var u=s.$theForm.find(".fluentform-step").index(s.$theForm.find(".fluentform-step.active"));if("prev"===r||u>-1&&n.activeStep<u)for(;n.activeStep>0&&n.isStepAllFieldsHidden(o(c[n.activeStep]));)n.activeStep--;else for(;n.activeStep<d-1&&n.isStepAllFieldsHidden(o(c[n.activeStep]));)n.activeStep++}c.css("display","none").removeClass("active").attr("aria-hidden","true"),o(c[n.activeStep]).css("display","block").addClass("active").attr("aria-hidden","false"),l.removeClass("ff_active ff_completed"),o.each(e(Array(n.activeStep).keys()),function(t){o(o(l[t])).addClass("ff_completed")}),o(l[n.activeStep]).addClass("ff_active");var p=o(c[n.activeStep]).closest(".ff-step-container").data("animation_type"),v=o(c[n.activeStep]);v.find(".step-nav button, .step-nav img").css("visibility","hidden");var h,m=d,_="none"===p?n.animateProgressToStep(n.activeStep,m,window.ffTransitionTimeOut||500):n.animateProgressToStep(n.activeStep,m,i);switch(p){case"slide":v.css({display:"block",position:"relative",left:n.isRtl?"-100%":"100%",opacity:0,transition:"all ".concat(i,"ms cubic-bezier(0.25, 0.1, 0.25, 1.0)")}),v[0].offsetHeight,v.css({left:"0%",opacity:1}),h=new Promise(function(t){return setTimeout(function(){v.css({position:"",left:"",transition:""}),t()},i+50)});break;case"fade":v.css({display:"block",opacity:0,transition:"opacity ".concat(i,"ms ease-in-out")}),v[0].offsetHeight,v.css("opacity",1),h=new Promise(function(t){return setTimeout(function(){v.css("transition",""),t()},i+50)});break;case"slide_down":v.css({display:"block",opacity:0,maxHeight:"0",overflow:"hidden",transition:"all ".concat(i,"ms cubic-bezier(0.25, 0.1, 0.25, 1.0)")}),v[0].offsetHeight;var g=v[0].scrollHeight;v.css({maxHeight:g+"px",opacity:1}),h=new Promise(function(t){return setTimeout(function(){v.css({maxHeight:"",overflow:"",transition:""}),t()},i+50)});break;default:var y=window.ffTransitionTimeOut||500;h=new Promise(function(t){return setTimeout(t,y)})}Promise.all([h,_]).then(function(){a&&function(){if(!window.ff_disable_step_scroll){var t,e,i,n,a,r,f=s.$theForm.find(".ff_step_start");t=window.ff_scroll_top_offset?window.ff_scroll_top_offset:f.offset().top-100,n=(i=(e=f).offset().top)+e.outerHeight(),r=(a=o(window).scrollTop())+o(window).height(),n>a&&i<r&&!window.ff_force_scroll||o("html, body").animate({scrollTop:t},500,"swing")}}(),function(){var e=0===t&&!a,i=s.$theForm.hasClass("ff_submitting");if(!s.stepPersistency||s.isPopulatingStepData||e||i||s.saveStepData(s.$theForm,s.activeStep).then(function(t){}),s.stepProgressBarHandle({activeStep:s.activeStep,totalSteps:d}),c.last().hasClass("active")?s.$theForm.find('button[type="submit"]').css("visibility","visible"):s.$theForm.find('button[type="submit"]').css("visibility","hidden"),!window.ff_disable_auto_step){var n=s.$theForm.find(".fluentform-step.active"),o=s.$theForm.find(".fluentform-step.active > div").length-1,l=s.$theForm.find(".fluentform-step.active > .ff_excluded").length;if(s.$theForm.find(".fluentform-step.active > .ff-t-container").length&&(o-=s.$theForm.find(".fluentform-step.active > .ff-t-container").length,o+=s.$theForm.find(".fluentform-step.active > .ff-t-container > .ff-t-cell > div").length,l+=s.$theForm.find(".fluentform-step.active > .ff-t-container > .ff-t-cell > .ff_excluded").length,s.$theForm.find(".fluentform-step.active > .ff-t-container.ff_excluded").length&&(l-=s.$theForm.find(".fluentform-step.active > .ff-t-container.ff_excluded").length,l-=s.$theForm.find(".fluentform-step.active > .ff-t-container.ff_excluded > .ff-t-cell > .ff_excluded").length,l+=s.$theForm.find(".fluentform-step.active > .ff-t-container.ff_excluded > .ff-t-cell > div").length)),o===l)return n.find(".step-nav button[data-action=".concat(r,"], .step-nav img[data-action=").concat(r,"]")).click(),void f()}s.$theForm.find(".fluentform-step.active").find('.step-nav button[data-action="next"]').css("visibility","visible"),s.$theForm.find(".fluentform-step.active").find('.step-nav button[data-action="prev"]').css("visibility","visible"),s.$theForm.find(".fluentform-step.active").find('.step-nav img[data-action="next"]').css("visibility","visible"),s.$theForm.find(".fluentform-step.active").find('.step-nav img[data-action="prev"]').css("visibility","visible"),f()}()})})}},{key:"handleFocus",value:function(t){var e=this.$,i=this,n=!1,a=function(n){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="yes"!=i.$theForm.find(".ff-step-container").attr("data-disable_auto_focus");if(!i.isInitialLoad)if(r){var o=n.find("input, .ff-custom_html, select, textarea, button, a").filter(":visible");o.length&&a&&setTimeout(function(){o.first().focus()},t+50),i.isInitialLoad=!1}else{var s;!(null===(s=window.fluentFormVars)||void 0===s||!s.step_change_focus)&&setTimeout(function(){e("".concat(i.formSelector," .fluentform-step.active")).attr("tabindex","-1").focus().removeAttr("tabindex")},t),i.isInitialLoad=!1}};i.$theForm.off("keydown.stepNavigation").on("keydown.stepNavigation",function(t){if(!n&&(" "===t.key||32===t.keyCode)){var a=e("".concat(i.formSelector," .fluentform-step.active .ff-btn-next")),r=e("".concat(i.formSelector," .fluentform-step.active .ff-btn-prev"));return document.activeElement===a[0]?(t.preventDefault(),void a.click()):document.activeElement===r[0]?(t.preventDefault(),void r.click()):void 0}}),this.$theForm.on("ff_to_next_page ff_to_prev_page",function(){n=!0,setTimeout(function(){n=!1,a(i.$theForm.find(".fluentform-step.active"),!0)},t+50)}),"yes"!==this.$theForm.find(".ff-step-container").attr("data-disable_auto_focus")&&0!==i.$theForm.find(".fluentform-step").index(i.$theForm.find(".fluentform-step.active"))&&!this.isInitialLoad&&a(e("".concat(this.formSelector," .fluentform-step.active")),!0),this.isInitialLoad=!1}},{key:"saveStepData",value:function(t,e){var i=this.$,n=t.find(":input").filter(function(t,e){return!i(e).closest(".has-conditions").hasClass("ff_excluded")});n.filter(function(t,e){var n=i(e);return n.parents().hasClass("ff_repeater_table")&&"select"==n.attr("type")&&!n.val()}).prepend("<option selected disabled />");var a=n.serialize();i.each(t.find("[type=file]"),function(t,e){var n={},r=e.name+"[]";n[r]=[],i(e).closest("div").find(".ff-uploaded-list").find(".ff-upload-preview[data-src]").each(function(t,e){n[r][t]=i(this).data("src")}),i.each(n,function(t,e){if(e.length){var n={};n[t]=e,a+="&"+i.param(n)}})});var r={active_step:e,data:a,form_id:t.data("form_id"),action:"fluentform_step_form_save_data"};return i.post(this.fluentFormVars.ajaxUrl,r)}},{key:"maybeAutoSlider",value:function(){var t=this.$;if("yes"==this.$theForm.find(".ff-step-container").attr("data-enable_auto_slider")){var e=function(t){if(1==t.closest(".fluentform-step.active").find(".ff-el-group:not(.ff_excluded):not(.ff-custom_html)").length)if(t.closest(".fluentform-step.active").find(".ff_excluded").length){var e=window.ffTransitionTimeOut||500;setTimeout(function(){t.closest(".fluentform-step.active").find(".ff-btn-next").trigger("click")},e)}else t.closest(".fluentform-step.active").find(".ff-btn-next").trigger("click")};this.$theForm.find(".ff-el-form-check-radio,.ff-el-net-label, .ff-el-ratings label").on("click",function(){e(t(this))}),this.$theForm.find("select").on("change",function(){e(t(this))})}}},{key:"addFilesToElement",value:function(e,i){var n=this.$,a=this,r=e.closest(".ff-el-input--content").find(".ff-uploaded-list");n.each(i,function(e,i){i="object"===t(i)?i:{url:i,data_src:i};var o=n("<div/>",{class:"ff-upload-preview","data-src":i.data_src,style:"border: 1px solid rgb(111, 117, 125)"}),s=n("<div/>",{class:"ff-upload-thumb"});s.append(n("<div/>",{class:"ff-upload-preview-img",style:"background-image: url('".concat(a.getThumbnail(i.url),"');")}));var f=n("<div/>",{class:"ff-upload-details"}),l=n("<span/>",{html:a.fluentFormVars.upload_completed_txt,class:"ff-upload-progress-inline-text ff-inline-block"}),c=i.url.substring(i.url.lastIndexOf("/")+1);c.includes("-ff-")&&(c=c.substring(c.lastIndexOf("-ff-")+4));var d=n("<div/>",{class:"ff-upload-filename",html:c}),u=n('\n            <div class="ff-upload-progress-inline ff-el-progress">\n                <div style="width: 100%;" class="ff-el-progress-bar"></div>\n            </div>\n        '),p=n("<span/>",{"data-href":"#",html:"&times;",class:"ff-upload-remove"}),v=n("<div>",{class:"ff-upload-filesize ff-inline-block",html:""}),h=n("<div>",{class:"ff-upload-error",style:"color:red;"});f.append(d,u,l,v,h,p),o.append(s,f),r.append(o)}),e.trigger("change_remaining",-i.length),e.trigger("change")}},{key:"getThumbnail",value:function(t){if(!t)return"";var e=t.split(/[#?]/)[0].split(".").pop().trim().toLowerCase();if(-1!=["jpg","jpeg","gif","png"].indexOf(e))return t;var i=document.createElement("canvas");i.width=60,i.height=60,i.style.zIndex=8,i.style.position="absolute",i.style.border="1px solid";var n=i.getContext("2d");return n.fillStyle="rgba(0, 0, 0, 0.2)",n.fillRect(0,0,60,60),n.font="13px Arial",n.fillStyle="white",n.textAlign="center",n.fillText(e,30,30,60),i.toDataURL()}}],a&&n(i.prototype,a),r&&n(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,a,r}();(r=jQuery)(document.body).on("fluentform_init",function(t,e,i){var n="."+i.form_instance,a=-1,s="no";if(r(n).hasClass("ff-form-has-save-progress")){r(n).hasClass("ff-form-has-steps")&&(e.on("ff_to_next_page",function(t,e){s=e}),e.on("ff_to_prev_page",function(t,e){s=e})),r(n).find(".ff-btn-save-progress").each(function(t,i){var n=r(i);n.on("click",function(t){var i,o=this;t.preventDefault(),n.addClass("ff-working");var f=e.find(":input").filter(function(t,e){return!r(e).closest(".has-conditions").hasClass("ff_excluded")});f.filter(function(t,e){var i=r(e);return i.parents().hasClass("ff_repeater_table")&&"select"==i.attr("type")&&!i.val()}).prepend("<option selected disabled />");var l=f.serialize();r.each(e.find("[type=file]"),function(t,e){var i={},n=e.name+"[]";i[n]=[],r(e).closest("div").find(".ff-uploaded-list").find(".ff-upload-preview[data-src]").each(function(t,e){i[n][t]=r(this).data("src")}),r.each(i,function(t,e){if(e.length){var i={};i[t]=e,l+="&"+r.param(i)}})}),a=null===(i=window.form_state_save_vars)||void 0===i?void 0:i.key;var c={source_url:window.form_state_save_vars.source_url,action:"fluentform_save_form_progress_with_link",data:l,form_id:e.data("form_id"),hash:a,active_step:s,nonce:window.form_state_save_vars.nonce,save_progress_btn_name:r(n).attr("name")},d=c.form_id+"_save_progress_msg",u="#"+d;jQuery.post(fluentFormVars.ajaxUrl,c).then(function(t){if(t){var i;a=t.data.hash,e.find(".ff-saved-state-link"),""!=(null===(i=t.data)||void 0===i?void 0:i.message)&&(r(u).length&&r(u).slideUp("fast"),r("<div/>",{id:d,class:"ff-message-success ff-el-group"}).html(t.data.message).insertBefore(n.closest(".ff-el-group")));var s=window.form_state_save_vars.copy_button||"Copy",f='<div class="ff-el-input--content">\n                                <div class="ff_input-group">\n                                    <input readonly value="'.concat(t.data.saved_url,'" class="ff-el-form-control" >\n                                    <div class="ff_input-group-append">\n                                        <button class="ff-btn ff-btn-md ff_btn_style ff_btn_copy_link ff_input-group-text">').concat(s,"</button>\n                                    </div>\n                                </div>\n                            </div>"),l=r("<div/>",{class:"ff-el-group ff-saved-state-input ff-saved-state-link ff-hide-group",html:f});r(o).closest(".ff-el-group").after(l),l.fadeIn(),l.find("input.ff-el-form-control").on("keypress",function(t){13!==t.which&&13!==t.keyCode||(t.preventDefault(),r(this).siblings(".ff_input-group-append").find(".ff_btn_copy_link").click())});var c=window.form_state_save_vars.email_placeholder_str||"Your Email Here",p=window.form_state_save_vars.email_button||"Email";if(r(o).hasClass("ff_resume_email_enabled")){var v='<div class="ff-el-input--content">\n                                    <div class="ff_input-group">\n                                        <input type="email" class="ff-el-form-control" placeholder="'.concat(c,'">\n                                        <div class="ff_input-group-append">\n                                            <button class="ff-btn ff-btn-md ff_btn_style ff_btn_is_email ff_input-group-text">').concat(p,"</button>\n                                        </div>\n                                    </div>\n                                </div>"),h=r("<div/>",{class:"ff-el-group ff-saved-state-input  ff-email-address ff-hide-group",html:v});r(l).after(h),h.fadeIn(),h.find("input.ff-el-form-control").on("keypress",function(t){13!==t.which&&13!==t.keyCode||(t.preventDefault(),r(this).siblings(".ff_input-group-append").find(".ff_btn_is_email").click())})}}}).fail(function(t){r(u).length&&r(u).slideUp("fast"),r("<div/>",{id:d,class:"ff-message-success ff-el-group text-danger"}).html(t.responseJSON.data.message).insertBefore(n.closest(".ff-el-group"))}).always(function(){n.parent().hide()})})}),r(n).on("click",".ff_btn_copy_link",function(t){t.preventDefault();var e=r(this).closest(".ff-el-input--content").find(".ff-el-form-control").val();navigator.clipboard.writeText(e);var i=window.form_state_save_vars.copy_success_button||"Copied";r(this).html("".concat(i))}),r(n).on("click",".ff_btn_is_email",function(t){t.preventDefault();var i=r(this).closest(".ff-el-group"),n=r(this).closest(".ff-email-address").find("input").val();r(".ff-email-address").find("input").val("");var o=r(".ff-saved-state-link").find("input").val(),s={source_url:window.form_state_save_vars.source_url,action:"fluentform_email_progress_link",form_id:e.data("form_id"),to_email:n,link:o,hash:a,nonce:window.form_state_save_vars.nonce},f=s.form_id+"_save_progress_email_response",l="#"+f;jQuery.post(fluentFormVars.ajaxUrl,s).then(function(t){t&&(i.removeClass("ff-el-is-error"),r(l).length&&r(l).slideUp("fast"),r("<div/>",{id:f,class:"ff-message-success ff-el-group"}).html(t.data.response).insertAfter(i))}).fail(function(t){t&&(i.addClass("ff-el-is-error"),r(l).length&&r(l).slideUp("fast"),r("<div/>",{id:f,class:"ff-message-success ff-el-group text-danger"}).html(t.responseJSON.data.Error).insertAfter(i))})});var f=!1;void 0!==window.form_state_save_vars&&(f=window.form_state_save_vars.key),f&&(e.append('<input type="hidden" value="'.concat(f,'" class="__fluent_state_hash" name="__fluent_state_hash"/>')),"yes"==e.find(".ff-step-container").attr("data-enable_step_data_persistency")||jQuery.getJSON(fluentFormVars.ajaxUrl,{form_id:e.data("form_id"),action:"fluentform_get_form_state",hash:f,nonce:window.form_state_save_vars.nonce}).then(function(t){if(t){var i=function(t,e,i,n){return new o(t,e,i,n).getPublicAPI()}(r,e,window.fluentFormVars,n);i.populateFormDataAndSetActiveStep(t)}}))}})})();