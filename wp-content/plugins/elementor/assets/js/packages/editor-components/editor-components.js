/*! For license information please see editor-components.js.LICENSE.txt */
!function(){"use strict";var e={"./packages/packages/core/editor-components/src/api.ts":function(e,t,n){n.r(t),n.d(t,{apiClient:function(){return s}});var o=n("@elementor/http-client");const r="elementor/v1/components",s={get:()=>(0,o.httpService)().get(`${r}`).then(e=>e.data.data),create:e=>(0,o.httpService)().post(`${r}`,e).then(e=>e.data.data)}},"./packages/packages/core/editor-components/src/components/components-tab.tsx":function(e,t,n){n.r(t),n.d(t,{ComponentsTab:function(){return ComponentsTab}});var o=n("react"),r=n("@elementor/ui");function ComponentsTab(){return o.createElement(r.Box,{px:2},"This is the Components tab.")}},"./packages/packages/core/editor-components/src/components/create-component-form/create-component-form.tsx":function(e,t,n){n.r(t),n.d(t,{CreateComponentForm:function(){return CreateComponentForm}});var o=n("react"),r=n("@elementor/editor-elements"),s=n("@elementor/editor-ui"),c=n("@elementor/icons"),a=n("@elementor/ui"),i=n("@wordpress/i18n"),m=n("./packages/packages/core/editor-components/src/hooks/use-components.ts"),p=n("./packages/packages/core/editor-components/src/hooks/use-create-component.ts"),l=n("./packages/packages/core/editor-components/src/components/create-component-form/hooks/use-form.ts"),u=n("./packages/packages/core/editor-components/src/components/create-component-form/utils/component-form-schema.ts"),d=n("./packages/packages/core/editor-components/src/components/create-component-form/utils/replace-element-with-component.ts");function CreateComponentForm(){const[e,t]=(0,o.useState)(null),[n,c]=(0,o.useState)(),[m,l]=(0,o.useState)(null),{mutate:u,isPending:_}=(0,p.useCreateComponentMutation)();(0,o.useEffect)(()=>{const e="elementor/editor/open-save-as-component-form",openPopup=e=>{t({element:e.detail.element,elementLabel:(0,r.getElementLabel)(e.detail.element.id)}),c(e.detail.anchorPosition)};return window.addEventListener(e,openPopup),()=>{window.removeEventListener(e,openPopup)}},[]);const resetAndClosePopup=()=>{t(null),c(void 0)};return o.createElement(s.ThemeProvider,null,o.createElement(a.Popover,{open:null!==e,onClose:resetAndClosePopup,anchorReference:"anchorPosition",anchorPosition:n},null!==e&&o.createElement(Form,{initialValues:{componentName:e.elementLabel},handleSave:async t=>{if(!e)throw new Error("Can't save element as component: element not found");u({name:t.componentName,content:[e.element.model.toJSON({remove:["default"]})]},{onSuccess:n=>{if(!e)throw new Error("Can't replace element with component: element not found");(0,d.replaceElementWithComponent)(e.element,n.component_id),l({show:!0,message:(0,i.__)("Component saved successfully as: %1$s (ID: %2$s)","elementor").replace("%1$s",t.componentName).replace("%2$s",n.component_id.toString()),type:"success"}),resetAndClosePopup()},onError:()=>{const e=(0,i.__)("Failed to save component. Please try again.","elementor");l({show:!0,message:e,type:"error"})}})},isSubmitting:_,closePopup:resetAndClosePopup})),o.createElement(a.Snackbar,{open:m?.show,onClose:()=>l(null)},o.createElement(a.Alert,{onClose:()=>l(null),severity:m?.type,sx:{width:"100%"}},m?.message)))}const _="tiny",Form=({initialValues:e,handleSave:t,isSubmitting:n,closePopup:r})=>{const{values:s,errors:p,isValid:d,handleChange:f,validateForm:g}=(0,l.useForm)(e),{data:w}=(0,m.useComponents)(),h=(0,o.useMemo)(()=>w?.map(e=>e.name)??[],[w]),k=(0,o.useMemo)(()=>(0,u.createBaseComponentSchema)(h),[h]),C=(0,o.useMemo)(()=>(0,u.createSubmitComponentSchema)(h),[h]);return o.createElement(a.Stack,{alignItems:"start",width:"268px"},o.createElement(a.Stack,{direction:"row",alignItems:"center",py:1,px:1.5,sx:{columnGap:.5,borderBottom:"1px solid",borderColor:"divider",width:"100%"}},o.createElement(c.StarIcon,{fontSize:_}),o.createElement(a.Typography,{variant:"caption",sx:{color:"text.primary",fontWeight:"500",lineHeight:1}},(0,i.__)("Save as a component","elementor"))),o.createElement(a.Grid,{container:!0,gap:.75,alignItems:"start",p:1.5},o.createElement(a.Grid,{item:!0,xs:12},o.createElement(a.FormLabel,{htmlFor:"component-name",size:"tiny"},(0,i.__)("Name","elementor"))),o.createElement(a.Grid,{item:!0,xs:12},o.createElement(a.TextField,{id:"component-name",size:_,fullWidth:!0,value:s.componentName,onChange:e=>f(e,"componentName",k),inputProps:{style:{color:"text.primary",fontWeight:"600"}},error:Boolean(p.componentName),helperText:p.componentName}))),o.createElement(a.Stack,{direction:"row",justifyContent:"flex-end",alignSelf:"end",py:1,px:1.5},o.createElement(a.Button,{onClick:r,disabled:n,color:"secondary",variant:"text",size:"small"},(0,i.__)("Cancel","elementor")),o.createElement(a.Button,{onClick:()=>{const{success:e,parsedValues:n}=g(C);e&&t(n)},disabled:n||!d,variant:"contained",color:"primary",size:"small"},n?(0,i.__)("Creatingâ€¦","elementor"):(0,i.__)("Create","elementor"))))}},"./packages/packages/core/editor-components/src/components/create-component-form/hooks/use-form.ts":function(e,t,n){n.r(t),n.d(t,{useForm:function(){return useForm}});var o=n("react");const useForm=e=>{const[t,n]=(0,o.useState)(e),[r,s]=(0,o.useState)({}),c=(0,o.useMemo)(()=>!Object.values(r).some(e=>e),[r]);return{values:t,errors:r,isValid:c,handleChange:(e,o,r)=>{const c={...t,[o]:e.target.value};n(c);const{success:a,errors:i}=validateForm(c,r);s(a?{}:i)},validateForm:e=>{const{success:n,errors:o,parsedValues:r}=validateForm(t,e);return n?(s({}),{success:n,parsedValues:r}):(s(o),{success:n})}}},validateForm=(e,t)=>{const n=t.safeParse(e);if(n.success)return{success:!0,parsedValues:n.data};const o={};return Object.entries(n.error.formErrors.fieldErrors).forEach(([e,t])=>{o[e]=t[0]}),{success:!1,errors:o}}},"./packages/packages/core/editor-components/src/components/create-component-form/utils/component-form-schema.ts":function(e,t,n){n.r(t),n.d(t,{createBaseComponentSchema:function(){return createBaseComponentSchema},createSubmitComponentSchema:function(){return createSubmitComponentSchema}});var o=n("@elementor/schema"),r=n("@wordpress/i18n");const createBaseComponentSchema=e=>o.z.object({componentName:o.z.string().trim().max(50,(0,r.__)("Component name is too long. Please keep it under 50 characters.","elementor")).refine(t=>!e.includes(t),{message:(0,r.__)("Component name already exists","elementor")})}),createSubmitComponentSchema=e=>{const t=createBaseComponentSchema(e);return t.extend({componentName:t.shape.componentName.refine(e=>e.length>0,{message:(0,r.__)("Component name is required.","elementor")}).refine(e=>e.length>=2,{message:(0,r.__)("Component name is too short. Please enter at least 2 characters.","elementor")})})}},"./packages/packages/core/editor-components/src/components/create-component-form/utils/replace-element-with-component.ts":function(e,t,n){n.r(t),n.d(t,{replaceElementWithComponent:function(){return replaceElementWithComponent}});var o=n("@elementor/editor-elements"),r=n("@elementor/editor-props");const replaceElementWithComponent=async(e,t)=>{(0,o.replaceElement)({currentElement:e,newElement:{elType:"widget",widgetType:"e-component",settings:{component_id:r.numberPropTypeUtil.create(t)}},withHistory:!1})}},"./packages/packages/core/editor-components/src/hooks/use-components.ts":function(e,t,n){n.r(t),n.d(t,{COMPONENTS_QUERY_KEY:function(){return s},useComponents:function(){return useComponents}});var o=n("@elementor/query"),r=n("./packages/packages/core/editor-components/src/api.ts");const s="components",useComponents=()=>(0,o.useQuery)({queryKey:[s],queryFn:r.apiClient.get,staleTime:1/0})},"./packages/packages/core/editor-components/src/hooks/use-create-component.ts":function(e,t,n){n.r(t),n.d(t,{useCreateComponentMutation:function(){return useCreateComponentMutation}});var o=n("@elementor/query"),r=n("./packages/packages/core/editor-components/src/api.ts"),s=n("./packages/packages/core/editor-components/src/hooks/use-components.ts");const useCreateComponentMutation=()=>{const e=(0,o.useQueryClient)();return(0,o.useMutation)({mutationFn:r.apiClient.create,onSuccess:()=>e.invalidateQueries({queryKey:[s.COMPONENTS_QUERY_KEY]})})}},"./packages/packages/core/editor-components/src/init.ts":function(e,t,n){n.r(t),n.d(t,{init:function(){return init}});var o=n("@elementor/editor"),r=n("@elementor/editor-elements-panel"),s=n("@wordpress/i18n"),c=n("./packages/packages/core/editor-components/src/components/components-tab.tsx"),a=n("./packages/packages/core/editor-components/src/components/create-component-form/create-component-form.tsx");function init(){(0,r.injectTab)({id:"components",label:(0,s.__)("Components","elementor"),component:c.ComponentsTab}),(0,o.injectIntoTop)({id:"create-component-popup",component:a.CreateComponentForm})}},"@elementor/editor":function(e){e.exports=window.elementorV2.editor},"@elementor/editor-elements":function(e){e.exports=window.elementorV2.editorElements},"@elementor/editor-elements-panel":function(e){e.exports=window.elementorV2.editorElementsPanel},"@elementor/editor-props":function(e){e.exports=window.elementorV2.editorProps},"@elementor/editor-ui":function(e){e.exports=window.elementorV2.editorUi},"@elementor/http-client":function(e){e.exports=window.elementorV2.httpClient},"@elementor/icons":function(e){e.exports=window.elementorV2.icons},"@elementor/query":function(e){e.exports=window.elementorV2.query},"@elementor/schema":function(e){e.exports=window.elementorV2.schema},"@elementor/ui":function(e){e.exports=window.elementorV2.ui},"@wordpress/i18n":function(e){e.exports=window.wp.i18n},react:function(e){e.exports=window.React}},t={};function __webpack_require__(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};!function(){__webpack_require__.r(n),__webpack_require__.d(n,{init:function(){return e.init}});var e=__webpack_require__("./packages/packages/core/editor-components/src/init.ts")}(),(window.elementorV2=window.elementorV2||{}).editorComponents=n}(),window.elementorV2.editorComponents?.init?.();
//# sourceMappingURL=editor-components.js.map