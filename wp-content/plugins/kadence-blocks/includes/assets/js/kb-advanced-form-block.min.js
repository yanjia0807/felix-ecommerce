(function(){"use strict";window.kadenceAdvancedForm={error_item:1,clearForm(a){a.reset()},ensureLiveRegion(a){let b=a.querySelector(".kb-form-live-region");return b||(b=document.createElement("div"),b.className="kb-form-live-region",b.setAttribute("aria-live","polite"),b.setAttribute("aria-atomic","true"),b.setAttribute("role","status"),b.style.position="absolute",b.style.left="-10000px",b.style.width="1px",b.style.height="1px",b.style.overflow="hidden",a.appendChild(b)),b},announceMessage(a,b,c="polite"){const d=window.kadenceAdvancedForm.ensureLiveRegion(a);d.textContent="",d.setAttribute("aria-live",c),setTimeout(()=>{d.textContent=b},100)},insertAfter(a,b){b.parentNode.insertBefore(a,b.nextSibling)},markError(a,b,c,d=null,e=null){let f="";if(c.classList.contains("kb-adv-form-has-error")||c.classList.add("kb-adv-form-has-error"),a.classList.add("has-error"),b){switch(b){case"required":const c=a.getAttribute("data-kb-required-message");if(c&&""!==c){f=c;break}f=a.getAttribute("data-required-message"),f&&""!==f&&void 0!==f||(f=a.getAttribute("data-label"),(!f||""===f||void 0===f)&&(f=kb_adv_form_params.item),f=f+" "+kb_adv_form_params[b]);break;case"mismatch":f=a.getAttribute("data-mismatch-message"),f&&""!==f&&void 0!==f||(f=a.getAttribute("data-label"),(!f||""===f||void 0===f)&&(f=kb_adv_form_params.item),f=f+" "+kb_adv_form_params[b]);break;case"validation":f=a.getAttribute("data-validation-message"),f&&""!==f&&void 0!==f||(f=a.getAttribute("data-label"),(!f||""===f||void 0===f)&&(f=kb_adv_form_params.item),f=f+" "+kb_adv_form_params[b]);break;case"custom":const d=e?.message;f=d?d:a.getAttribute("data-label")+" has an issue"}const c=a.parentNode.querySelector(".kb-adv-form-error-msg");c&&c.remove();const g=a.getAttribute("name")+"-error";a.setAttribute("aria-describedby",g),a.setAttribute("aria-invalid","true");const h=document.createElement("div");h.id=g,h.classList.add("kb-adv-form-error-msg"),h.classList.add("kb-adv-form-message"),h.classList.add("kb-adv-form-warning"),h.innerHTML=window.kadenceAdvancedForm.strip_tags(f,"<div><a><b><i><u><p><ol><ul>"),a.classList.contains("kb-accept-field")?a.parentNode.parentNode.append(h):a.classList.contains("kb-checkbox-field")||a.classList.contains("kb-radio-field")?a.parentNode.append(h):window.kadenceAdvancedForm.insertAfter(h,a),d&&f&&d.push({message:f,item:a})}window.kadenceAdvancedForm.error_item++},addErrorNotice(a,b=[],c=""){let d=a.getAttribute("data-error-message");d&&""!==d&&void 0!==d||(d=kb_adv_form_params.error_message);const e=c||d;let f="<h2 class=\"kb-adv-form-error-title\">"+e+"</h2>";console.log(f),0<b.length&&(f+="<ol class=\"kb-adv-form-field-errors\">",b.forEach(function(a){const b=a.message,c=a.item,d=c.getAttribute("id")||c.getAttribute("name");f+=d?"<li><a href=\"#"+d+"\" class=\"kb-adv-form-error-link\" data-field-id=\""+d+"\">"+window.kadenceAdvancedForm.strip_tags(b,"<div><a><b><i><u><p><ol><ul>")+"</a></li>":"<li>"+window.kadenceAdvancedForm.strip_tags(b,"<div><a><b><i><u><p><ol><ul>")+"</li>"}),f+="</ol>");const g=document.createElement("div");g.classList.add("kb-adv-form-message"),g.classList.add("kb-adv-form-warning"),g.setAttribute("role","alert"),g.setAttribute("aria-live","assertive"),g.setAttribute("tabindex","-1"),g.innerHTML=window.kadenceAdvancedForm.strip_tags(f,"<div><a><b><i><u><p><ol><ul><li><h2><h3><h4><h5><h6>"),a.parentNode.insertBefore(g,a),g.focus()},isValidEmail(a){const b=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return b.test(a)},isValidURL(a){return /^(http:\/\/www.|https:\/\/www.|ftp:\/\/www.|www.|http:\/\/|https:\/\/){1}([0-9A-Za-z]+.)/.test(a)},isValidTel(a){return /\/^[+]?[(]?[0-9]{3}[)]?[-s.]?[0-9]{3}[-s.]?[0-9]{4,6}$\/im/.test(a)},removeErrors(a){a.classList.contains("kb-adv-form-has-error")&&a.classList.remove("kb-adv-form-has-error");const b=a.querySelectorAll(".has-error");if(b.length)for(var c=0;c<b.length;c++){b[c].classList.remove("has-error"),b[c].removeAttribute("aria-describedby"),b[c].removeAttribute("aria-invalid");const a=b[c].parentNode.querySelector(".kb-adv-form-error-msg");a&&a.remove()}const d=document.querySelectorAll(".kb-adv-form-message");if(d.length)for(var c=0;c<d.length;c++)d[c].remove();const e=a.querySelectorAll(".kb-adv-form-errors");if(e.length)for(var c=0;c<e.length;c++)e[c].remove()},serialize(a){const b={};for(const[c,d]of a)void 0===b[c]?b[c]=d:(Array.isArray(b[c])||(b[c]=[b[c]]),b[c].push(d));return b},validateForm(a){let b=!1,c="";const d=[];window.kadenceAdvancedForm.removeErrors(a);const e=a.querySelectorAll("[data-required=\"yes\"]:not([disabled])");if(e.length)for(let i=0;i<e.length;i++){var f=e[i].getAttribute("data-type"),g="";switch(f){case"textarea":case"text":g=e[i].value.trim(),""===g&&(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d));break;case"tel":g=e[i].value.trim(),""!==g||""===g&&(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d));break;case"accept":!1==e[i].checked&&(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d));break;case"select":g=e[i].value,e[i].multiple?(null===g||0===g.length)&&(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d)):(!g||"-1"===g)&&(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d));break;case"radio":var h=e[i].querySelector("input:checked");h||(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d));break;case"checkbox":var h=e[i].querySelector("input:checked");h||(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d));break;case"email":var g=e[i].value.trim();""===g?""===g&&(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d)):!window.kadenceAdvancedForm.isValidEmail(g)&&(b=!0,c="validation",window.kadenceAdvancedForm.markError(e[i],c,a,d));break;case"url":var g=e[i].value.trim();""===g?""===g&&(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d)):!window.kadenceAdvancedForm.isValidURL(g)&&(b=!0,c="validation",window.kadenceAdvancedForm.markError(e[i],c,a,d));break;case"file":g=e[i].value.trim(),""===g&&(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d));break;case"number":g=e[i].value.trim(),""===g&&(b=!0,c="required",window.kadenceAdvancedForm.markError(e[i],c,a,d))}}if(b)return window.kadenceAdvancedForm.addErrorNotice(a,d),!1;const i=new FormData(a);return i.set("_kb_form_verify",kb_adv_form_params.nonce),i},strip_tags(a,b){b=(((b||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return a.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(a,c){return-1<b.indexOf("<"+c.toLowerCase()+">")?a:""})},createElementFromHTML(a){const b=document.createElement("div");return b.innerHTML=window.kadenceAdvancedForm.strip_tags(a,"<div><a><b><i><u><p><ol><ul><li>"),b.firstChild},extractTextFromHTML(a){const b=document.createElement("div");return b.innerHTML=a,b.textContent||b.innerText||""},submit(a,b){a.preventDefault();const c=new Event("kb-adv-form-start-submit");window.document.body.dispatchEvent(c);const d=b.querySelector(".kb-adv-form-submit-button"),e=window.kadenceAdvancedForm.validateForm(b);if(e){const a=document.createElement("div");a.classList.add("kb-adv-form-loading"),a.innerHTML="<div class=\"kb-adv-form-loading-spin\"><div></div><div></div><div></div><div></div></div>",b.append(a),d.setAttribute("disabled","disabled"),d.classList.add("button-primary-disabled");fetch(kb_adv_form_params.ajaxurl,{method:"POST",body:e}).then(a=>{if(b.querySelector(".g-recaptcha")&&grecaptcha.reset(),d.removeAttribute("disabled"),d.classList.remove("button-primary-disabled"),b.querySelector(".kb-adv-form-loading").remove(),200<=a.status&&400>a.status)return a.json()}).then(a=>{const c=a;if(c.success){const a=c?.submissionResults,d=new CustomEvent("kb-advanced-form-success",{detail:{uniqueId:b.querySelector("input[name=\"_kb_adv_form_id\"]")?b.querySelector("input[name=\"_kb_adv_form_id\"]").value:"",submissionResults:a}});if(window.document.body.dispatchEvent(d),window.kadenceAdvancedForm.event("submitted",b),c.redirect)window.location.replace(c.redirect);else{window.kadenceAdvancedForm.insertAfter(window.kadenceAdvancedForm.createElementFromHTML(c.html),b);const a=window.kadenceAdvancedForm.extractTextFromHTML(c.html);if(window.kadenceAdvancedForm.announceMessage(b,a,"polite"),window.kadenceAdvancedForm.clearForm(b),c?.hide){const a=b.parentNode.querySelector(".kb-adv-form-message");a&&(a.setAttribute("tabindex","-1"),a.focus()),b.remove()}}}else if(c.data){window.kadenceAdvancedForm.event("failed",b);const a=[];if(c.data.fieldErrors)for(const d of c.data.fieldErrors)if(b.querySelector("[name=\""+d.field+"\"]")){const c=d.type||"required";window.kadenceAdvancedForm.markError(b.querySelector("[name=\""+d.field+"\"]"),c,b,a,d)}window.kadenceAdvancedForm.addErrorNotice(b,a,c.data.message)}}).catch(function(){console.log("Connection error")})}},event(a,b){if("yes"===b.getAttribute("data-kb-events")){const c=new FormData;c.set("action","kadence_adv_form_event"),c.set("type",a),c.set("_kb_form_verify",kb_adv_form_params.nonce),c.set("_kb_adv_form_post_id",b.querySelector("input[name=\"_kb_adv_form_post_id\"]").value);fetch(kb_adv_form_params.ajaxurl,{method:"POST",body:c}).then(a=>{if(200<=a.status&&400>a.status)return a.json()}).then(()=>{}).catch(function(){console.log("Connection error")})}},initForms(){const a=document.querySelectorAll("form.kb-advanced-form");if(!a.length)return;const b=function(a){return function(){window.kadenceAdvancedForm.event("started",a)}},c=function(a){return function(b){window.kadenceAdvancedForm.submit(b,a)}};for(let d=0;d<a.length;d++)window.kadenceAdvancedForm.event("viewed",a[d]),a[d].addEventListener("change",b(a[d]),{once:!0}),a[d].addEventListener("submit",c(a[d]))},initFloatingLabels(){const a=document.querySelectorAll(".kb-adv-form-label-style-float .kb-adv-form-text-type-input input, .kb-adv-form-label-style-float .kb-adv-form-text-type-input textarea");if(!a.length)return;const b=function(a){return function(){a.parentNode.classList.add("kb-form-field-focus")}},c=function(a){return function(){a.value||a.parentNode.classList.remove("kb-form-field-focus")}};for(let d=0;d<a.length;d++)a[d].value&&a[d].parentNode.classList.add("kb-form-field-focus"),a[d].addEventListener("focus",b(a[d])),a[d].addEventListener("blur",c(a[d]))},init(){return"undefined"!=typeof kb_adv_form_params&&void(window.kadenceAdvancedForm.initForms(),window.kadenceAdvancedForm.initFloatingLabels())}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",window.kadenceAdvancedForm.init):window.kadenceAdvancedForm.init()})();